# TeamWiki - Software Requirements Specification (FINAL)

> **버전**: 1.0 Final
> **최종 수정**: 2026-01-27
> **기반**: SRS.md + INTERVIEW.md 요구사항 명확화

---

## 1. 프로젝트 개요

팀을 위한 AI 기반 지식 관리 시스템

**목적:**
- 팀의 모든 지식을 한곳에 체계적으로 정리
- 실시간 협업으로 문서 작성
- AI가 자동으로 정리하고 추천
- Notion/Confluence 대체

**슬로건:**
"팀의 모든 지식을 AI가 정리"

**타겟 사용자:**
- 스타트업 팀 (5-50명)
- 개발팀
- 기획/마케팅팀
- 원격 근무 팀
- 프리랜서 그룹

---

## 2. 핵심 기능 (20 Features)

### 📝 문서 관리 (Feature 1-5)

#### Feature 1: 마크다운 에디터
```
- 리치 텍스트 편집
- 마크다운 지원 (# ** `` 등)
- 헤딩/리스트/테이블/코드블록
- 이미지 업로드 (드래그앤드롭)
  [추가됨] 지원 형식: PNG, JPG, GIF만
  [추가됨] 1MB 이상 이미지 자동 압축 (품질 80-85%, 최대 1920px)
  [추가됨] MIME 타입 검증 필수
  [추가됨] 문서 삭제 시 첨부 이미지도 즉시 삭제
- 키보드 단축키 (Cmd+B, Cmd+K 등)
- 자동 저장
  [추가됨] 저장 실패 시 LocalStorage 백업 + 자동 재시도 (최대 5회)
```

#### Feature 2: 실시간 협업 편집
```
[MVP에서 제외 - Phase 4로 연기]
- 여러 명이 동시 편집
- 다른 사용자 커서 표시
- 실시간 동기화
- 충돌 방지
- "누가 지금 보고 있음" 표시

[추가됨] 구현 시 기술 스택 결정 필요: Yjs vs Supabase Realtime vs Pusher
```

#### Feature 3: 버전 히스토리
```
- 모든 수정 기록 저장
  [추가됨] 영구 보관 - 모든 버전 유지
  [추가됨] 자동 저장 시 내용 변경 감지 후 버전 생성
  [추가됨] 버전 간 diff 알고리즘으로 효율적 저장
- 타임라인 뷰
- 버전간 비교 (diff)
- 이전 버전 복원
  [추가됨] 문서 작성자 + Admin/Owner만 복원 가능
- 누가 언제 수정했는지
```

#### Feature 4: 문서 템플릿
```
템플릿 종류:
- 📝 회의록 (날짜/참석자/안건/결정사항)
- 📋 PRD (Product Requirements Document)
- 🏗️ 기술 설계서
- 📊 주간 보고서
- 🎯 OKR
- 📖 온보딩 가이드
- 🐛 버그 리포트
- 빈 문서

사용자 정의 템플릿 저장 가능
[추가됨] 템플릿 생성 권한: 모든 사용자 (Editor 이상)
```

#### Feature 5: 문서간 링크 (백링크)
```
- [[문서 제목]] 으로 링크
- 자동완성
- 백링크 표시 ("이 문서를 참조하는 문서")
- 링크 그래프 시각화 (선택)
  [추가됨] MVP는 기본 백링크 목록만, 시각화는 Phase 4
- 깨진 링크 감지
```

---

### 🔍 검색 & AI (Feature 6-10)

#### Feature 6: 전체 문서 검색
```
- 제목/내용 전체 검색
  [추가됨] 댓글 내용도 포함 검색
  [추가됨] 검색 결과에 출처 표시 (문서 본문 vs 댓글)
- 실시간 검색 결과
- 필터:
  - 작성자
  - 날짜 범위
  - 카테고리/태그
  - 즐겨찾기만
- 검색 하이라이트
- 최근 검색 기록

[추가됨] 구현: PostgreSQL Full-Text Search 또는 별도 검색 엔진
```

#### Feature 7: AI 자동 태깅
```
- 문서 저장 시 자동으로 태그 추천
  [수정됨] 저장 완료 후 백그라운드 작업으로 AI 호출 (비동기)
  [추가됨] API 실패 시 재시도 로직 (최대 3회)
- 내용 분석해서 적절한 태그 생성
- 기존 태그 활용
- 수동 태그도 가능
  [추가됨] 사용자는 AI 제안 태그를 수락/거부/수정 가능
  [추가됨] "제안된 태그" UI에 표시 후 사용자 최종 결정
- 태그 클라우드

[추가됨] 프라이버시: 문서 전체 내용이 OpenRouter API로 전송됨 (프라이버시 정책 명시)
[추가됨] OpenRouter 데이터 보관: 30일 후 자동 삭제
```

#### Feature 8: AI 문서 요약
```
- 긴 문서 자동 요약 (3줄)
  [수정됨] 저장 시 자동 생성 (백그라운드)
- 핵심 포인트 추출
- TL;DR 생성
- 목차 자동 생성
- 요약 버튼 클릭 시 생성
  [추가됨] 사용자가 요약 내용 편집 가능

[추가됨] 프라이버시: 문서 전체 내용이 OpenRouter API로 전송됨
```

#### Feature 9: 유사 문서 추천
```
- "이 문서를 본 사람은 이것도 봤어요"
- 내용 기반 유사도
- 같은 태그 문서
- 같은 작성자 문서
- 사이드바에 표시
```

#### Feature 10: AI Q&A (팀 지식 기반)
```
- "팀에게 질문하기" 기능
- 예: "배포 프로세스가 어떻게 되나요?"
- 전체 문서 검색해서 답변
- 참고 문서 링크 제공
- 답변 없으면 "관련 문서 없음" 표시
```

---

### 👥 협업 (Feature 11-15)

#### Feature 11: 댓글/멘션
```
- 문서 어디든 댓글
  [추가됨] Viewer 역할도 댓글 작성 가능 (읽기 + 댓글)
- @멘션으로 특정 사용자 호출
- 댓글 스레드
- 댓글 해결/재오픈
  [추가됨] "해결됨" 표시: 문서 작성자 + 댓글 작성자 가능
- 댓글 알림
  [추가됨] 댓글 수정/삭제 권한: 작성자 본인 + Admin/Owner
  [추가됨] Admin은 모든 댓글 삭제 가능 (수정은 불가)
```

#### Feature 12: 문서 공유
```
공유 레벨:
- 팀 전체 (기본)
- 특정 멤버만
- 링크 있는 사람 누구나 (읽기 전용)
- 비공개 (나만)

공유 링크:
- 고유 URL 생성
  [추가됨] URL 형식: /documents/{uuid} (제목 아닌 ID 기반)
  [추가됨] 토큰: 랜덤 UUID + 해싱
- 비밀번호 설정 (선택)
- 만료일 설정 (선택)
```

#### Feature 13: 권한 관리
```
역할:
- 👑 Owner (모든 권한)
- 🔧 Admin (멤버 관리, 설정)
  [추가됨] 모든 문서 삭제 가능
  [추가됨] 모든 댓글 삭제 가능
- ✍️ Editor (문서 생성/수정)
  [수정됨] 자신이 만든 문서만 삭제 가능
  [추가됨] 다른 사람 문서는 읽기/수정만 (편집 권한 있는 경우)
- 👀 Viewer (읽기만)
  [추가됨] 댓글 작성/수정(자신 것만) 가능
  [추가됨] 문서 편집/삭제는 불가

문서별 권한:
- 편집 가능
- 댓글만 가능
- 읽기 전용

[추가됨] 탈퇴 멤버 처리:
- 문서는 삭제하지 않고 유지
- 작성자 표시: "[탈퇴한 사용자] (이전: 홍길동)"
- Admin이 문서 소유권을 다른 멤버에게 이전 가능
- 탈퇴 멤버 문서 필터 기능 제공
```

#### Feature 14: 알림
```
알림 종류:
- 멘션됨
- 댓글 달림
- 문서 공유됨
- 중요 업데이트

알림 채널:
- 인앱 (벨 아이콘)
  [추가됨] MVP는 인앱 알림만
- 이메일 (선택)
  [추가됨] Phase 4 또는 Post-MVP
- Slack (연동 시)
  [추가됨] Phase 4 또는 Post-MVP

알림 설정:
- 즉시
- 일일 요약
- 끄기
```

#### Feature 15: 활동 피드
```
- 최근 활동 타임라인
- "누가 무엇을 했는지"
- 필터 (내가 쓴 것만/팀 전체)
- 실시간 업데이트
- 활동 타입:
  - 문서 생성
  - 문서 수정
  - 댓글
  - 공유
```

---

### 📊 구조화 (Feature 16-18)

#### Feature 16: 폴더/카테고리
```
구조:
- 워크스페이스 (팀)
  └─ 폴더 (예: "개발팀", "마케팅")
      └─ 하위 폴더
          └─ 문서

[추가됨] 최대 중첩 깊이: 5단계
[추가됨] 구조: 워크스페이스 > 폴더1 > 폴더2 > 폴더3 > 폴더4 > 폴더5
[추가됨] 폴더 생성 시 깊이 검증 로직 필요

기능:
- 폴더 생성/이름변경/삭제
- 드래그앤드롭으로 이동
- 폴더 공유 (하위 문서 모두)
- 폴더 아이콘/색상 커스터마이징
```

#### Feature 17: 태그 시스템
```
- #태그명
- 문서에 여러 태그 가능
- 태그별 문서 모아보기
- 태그 색상 지정
- 인기 태그 TOP 10
- 태그 검색
- 태그 머지 (중복 제거)
```

#### Feature 18: 즐겨찾기
```
- ⭐ 버튼으로 즐겨찾기 추가
- 사이드바 상단에 표시
- 드래그로 순서 변경
- 폴더도 즐겨찾기 가능
- 최대 20개
```

---

### 🎨 커스터마이징 (Feature 19-20)

#### Feature 19: 팀 브랜딩
```
- 팀 이름
- 팀 로고 업로드
- 브랜드 컬러 (Primary/Secondary)
- 커스텀 도메인 (선택)
- 팀 설명
```

#### Feature 20: 다크/라이트 모드
```
- 시스템 설정 따르기
- 라이트 모드
- 다크 모드
- 자동 전환 (시간대별)
```

---

## 3. 사용자 스토리

### Story 1: 신입 개발자 온보딩
```
상황: 김신입 개발자 첫 출근

1. 팀장이 초대 링크 전송
2. 회원가입 (이메일/비밀번호 또는 Google 로그인) [수정됨]
   [추가됨] 이메일 인증 불필요 - 바로 사용 가능
   [추가됨] 비밀번호 최소 6자
3. 워크스페이스 입장
4. 왼쪽 사이드바에 "📖 온보딩 가이드" 문서 보임
5. 클릭해서 읽기
   - 팀 소개
   - 개발 환경 세팅
   - 코딩 컨벤션
   - 배포 프로세스
6. 궁금한 점 → AI Q&A에 질문
   "배포는 어떻게 하나요?"
7. 답변 + 관련 문서 링크 제공
8. 문서에 댓글로 질문
9. 시니어가 @멘션으로 답변
10. 온보딩 완료!
```

### Story 2: 팀 회의록 작성
```
상황: 주간 팀 미팅 후

1. [+ 새 문서] 클릭
   [추가됨] 문서 개수 카운터 표시 (95/100)
2. 템플릿 선택: "📝 회의록"
3. 자동으로 구조 생성:
   - 날짜: 2024-01-30
   - 참석자: (입력)
   - 안건: (입력)
   - 결정사항: (입력)
   - 액션 아이템: (입력)
4. 실시간 협업으로 다 같이 작성 [Phase 4]
5. 액션 아이템에 @멘션으로 담당자 지정
6. 저장 → AI가 자동 태그 추천
   "#회의록 #주간미팅 #개발팀"
   [추가됨] 사용자가 태그 수락/거부/수정 가능
7. 폴더에 정리: "개발팀/회의록/2024"
8. Slack 알림 자동 전송 [Phase 4]
```

### Story 3: 문서 검색 & 재사용
```
상황: API 명세서 찾기

1. Cmd+K (빠른 검색)
2. "API 명세" 입력
3. 실시간 결과:
   - "결제 API 명세서"
   - "사용자 API 문서"
   - "인증 API 가이드"
   [추가됨] 댓글에서 검색된 결과도 표시 (출처 구분)
4. "결제 API 명세서" 클릭
5. 읽다가 유사 문서 추천 보임
   - "PG사 연동 가이드"
   - "결제 테스트 시나리오"
6. 백링크 확인
   - "이커머스 개발 가이드"에서 참조 중
7. 필요한 부분 복사해서 새 문서 작성
```

---

## 4. 기술 요구사항

### 필수:
- Next.js 16 (App Router)
- TypeScript
- PostgreSQL + Drizzle ORM
- Tiptap (에디터) 또는 Lexical
- OpenRouter API (AI 기능)
  [추가됨] Model: anthropic/claude-sonnet-4 (또는 openai/gpt-4o - 테스트 필요)
- Supabase 또는 Pusher (실시간 동기화) [Phase 4]
- Tailwind CSS + shadcn/ui
  [추가됨] 데스크톱 우선, 모바일 기본 반응형
- NextAuth.js (인증)
  [추가됨] Google OAuth Provider 지원
  [추가됨] Email/Password 방식 병행
- [추가됨] Sharp (이미지 최적화)
- [추가됨] bcrypt 또는 argon2 (비밀번호 해싱)

### 선택:
- Uploadthing (파일 업로드)
  [추가됨] 또는 Supabase Storage / AWS S3 - 비용/성능 비교 필요
- Resend (이메일 알림) [Phase 4]
- Slack API (Slack 연동) [Phase 4]
- React Beautiful DnD (드래그앤드롭)

---

## 5. 데이터베이스 스키마

### 핵심 테이블:

```sql
-- 워크스페이스
workspaces
  - id
  - name
  - logo_url
  - primary_color
  - created_at

-- 사용자
users
  - id
  - email
  - password_hash [추가됨] (nullable for OAuth users)
  - name
  - avatar_url
  - oauth_provider [추가됨] (google/github/null)
  - oauth_id [추가됨]
  - is_deleted [추가됨] (탈퇴 여부)
  - deleted_at [추가됨]
  - created_at

-- 워크스페이스 멤버
workspace_members
  - id
  - workspace_id
  - user_id
  - role (owner/admin/editor/viewer)
  - joined_at
  - [추가됨] left_at (nullable, 탈퇴 시각)
  - [추가됨] is_active (boolean)

-- 폴더
folders
  - id
  - workspace_id
  - parent_folder_id (nullable)
  - name
  - icon
  - color
  - depth [추가됨] (중첩 깊이, max 5)
  - created_by
  - created_at

-- 문서
documents
  - id
  - workspace_id
  - folder_id (nullable)
  - title [수정됨] (중복 허용, ID로 구분)
  - content (JSON/TEXT) [수정됨] (크기 제한 없음)
  - ai_summary [추가됨] (TEXT, AI 생성 요약)
  - created_by
  - updated_by
  - created_at
  - updated_at

-- 문서 버전 [수정됨]
document_versions
  - id
  - document_id
  - content (JSON)
  - diff [추가됨] (JSON, 이전 버전과의 차이)
  - created_by
  - created_at
  - [추가됨] 영구 보관, 자동 삭제 없음

-- 이미지/파일 [추가됨]
images
  - id
  - document_id
  - file_url
  - file_name
  - file_size
  - mime_type (image/png, image/jpeg, image/gif)
  - is_optimized (boolean)
  - created_at

-- 태그
tags
  - id
  - workspace_id
  - name
  - color
  - is_ai_generated [추가됨] (boolean)
  - created_at

-- 문서-태그 관계
document_tags
  - document_id
  - tag_id
  - is_accepted [추가됨] (boolean, AI 제안 수락 여부)

-- 댓글 [수정됨]
comments
  - id
  - document_id
  - user_id
  - content
  - parent_comment_id (nullable, for threads)
  - resolved
  - resolved_by [추가됨] (user_id)
  - created_at
  - updated_at [추가됨]
  - is_edited [추가됨] (boolean)

-- 즐겨찾기
favorites
  - id
  - user_id
  - document_id
  - folder_id (nullable)
  - order
  - created_at

-- 공유 링크 [수정됨]
share_links
  - id
  - document_id
  - token (UUID + hashed)
  - password (nullable, hashed)
  - expires_at (nullable)
  - view_count [추가됨] (integer)
  - created_by
  - created_at

-- 활동 로그
activities
  - id
  - workspace_id
  - user_id
  - action (created/updated/commented/shared/deleted)
  - target_type (document/folder/comment)
  - target_id
  - created_at

-- AI 작업 로그 [추가됨]
ai_jobs
  - id
  - document_id
  - job_type (tagging/summarize/qa)
  - status (pending/processing/completed/failed)
  - retry_count
  - error_message
  - created_at
  - completed_at
```

---

## 6. UI/UX 설계

### 메인 레이아웃:
```
┌─────────────────────────────────────────────────────┐
│  🏠 TeamWiki                    [+] 🔍  🔔  👤     │
│                                 [추가됨] 95/100     │
├──────────┬──────────────────────────────────────────┤
│          │                                          │
│ 사이드바 │              문서 뷰                     │
│          │                                          │
│ ⭐ 즐겨찾기│  ┌────────────────────────────────┐   │
│  - 온보딩 │  │  # 문서 제목                   │   │
│  - API   │  │  by 홍길동 · 2일 전            │   │
│          │  │                                │   │
│ 📁 폴더   │  │  [AI 제안 태그] #회의록 #개발팀│   │ [추가됨]
│  개발팀   │  │  [ ✓ 수락 ] [ ✗ 거부 ]         │   │ [추가됨]
│  ├ 회의록 │  │                                │   │
│  ├ 가이드 │  │  ## 개요                       │   │
│  └ API   │  │  이 문서는...                  │   │
│  (5단계)  │  │                                │   │ [추가됨]
│          │  │  ## 상세                       │   │
│  마케팅   │  │  내용...                       │   │
│  └ 캠페인 │  │                                │   │
│          │  │  [[관련문서]] 링크             │   │
│ 🏷️ 태그   │  │                                │   │
│  #회의록  │  └────────────────────────────────┘   │
│  #API    │                                          │
│          │  우측: 목차 / 댓글 / 히스토리           │
└──────────┴──────────────────────────────────────────┘

[추가됨] 데스크톱 우선 디자인
[추가됨] 모바일: 기본 반응형, 터치 제스처 최소화
```

### 에디터 뷰:
```
┌──────────────────────────────────────────────┐
│ [B] [I] [U] [H1] [H2] [•] [1.] ["""] [🖼️]   │
│                           [저장 중...] 💾     │ [추가됨]
├──────────────────────────────────────────────┤
│                                              │
│  # 문서 제목                                 │
│                                              │
│  마크다운으로 작성...                        │
│                                              │
│  - 리스트                                    │
│  - 아이템                                    │
│                                              │
│  ```javascript                               │
│  const code = 'syntax highlighting';         │
│  ```                                         │
│                                              │
│  ![이미지](auto-compressed.jpg) 1.2MB→800KB │ [추가됨]
│                                              │
│  [[다른 문서]] 링크                          │
│                                              │
└──────────────────────────────────────────────┘

[추가됨] 이미지 업로드: 드래그앤드롭, PNG/JPG/GIF, 자동 압축
[추가됨] 저장 실패 시 LocalStorage 백업 알림 표시
```

---

## 7. Phase별 개발 계획

### Phase 1: 기본 문서 (3-4시간)
```
Feature 1, 4, 16
- Next.js 프로젝트 설정
- 인증 (NextAuth)
  [추가됨] Google OAuth + Email/Password
  [추가됨] 비밀번호 해싱 (bcrypt)
  [추가됨] 이메일 인증 없이 즉시 사용 가능
- 마크다운 에디터 (Tiptap)
  [추가됨] 이미지 업로드 (Sharp 최적화)
  [추가됨] 자동 저장 + 실패 시 LocalStorage 백업
- 문서 CRUD
  [추가됨] 제목 중복 허용, ID 기반 URL
  [추가됨] 문서 크기 제한 없음
- 폴더 구조
  [추가됨] 최대 5단계 깊이 제한
```

### Phase 2: 협업 기초 (2-3시간)
```
Feature 11, 12, 13
- 댓글 시스템
  [추가됨] Viewer도 댓글 작성 가능
  [추가됨] 수정/삭제: 작성자 + Admin
- 멘션 기능
- 권한 관리
  [추가됨] Editor는 자신 문서만 삭제
  [추가됨] 탈퇴 멤버 문서 유지 로직
- 공유 링크
  [추가됨] UUID 기반 토큰, 해싱
```

### Phase 3: AI 기능 (2-3시간)
```
Feature 6, 7, 8, 10
- 전체 검색
  [추가됨] 댓글 포함 검색
  [추가됨] Full-Text Search
- AI 태깅
  [추가됨] 백그라운드 작업
  [추가됨] 사용자 수락/거부 UI
  [추가됨] 재시도 로직 (최대 3회)
- AI 요약
  [추가됨] 백그라운드 작업
  [추가됨] 편집 가능한 요약
- AI Q&A
  [추가됨] 프라이버시 정책 명시
```

### Phase 4: 고급 기능 (2-3시간)
```
Feature 2, 3, 5, 9, 14, 15, 17, 18, 19, 20
- 실시간 협업 (Supabase/Yjs/Pusher 선택)
- 버전 히스토리
  [추가됨] 영구 보관
  [추가됨] Diff 알고리즘
- 백링크
  [추가됨] 시각화는 선택 사항
- 유사 문서
- 알림
  [추가됨] MVP는 인앱만
- 활동 피드
- 태그 시스템
- 즐겨찾기
- 브랜딩
- 다크모드
```

**총 예상 시간: 9-13시간**

---

## 8. MVP 범위 (Day 30)

### 오늘 구현할 기능 (10개):
```
✅ Feature 1: 마크다운 에디터
   [추가됨] + 이미지 최적화 + 자동 저장 백업
✅ Feature 4: 문서 템플릿 (3개)
✅ Feature 6: 전체 검색
   [추가됨] + 댓글 검색
✅ Feature 7: AI 태깅
   [추가됨] + 수락/거부 UI
✅ Feature 8: AI 요약
   [추가됨] + 편집 가능
✅ Feature 11: 댓글
   [추가됨] + Viewer 권한 + 수정/삭제 규칙
✅ Feature 12: 공유
   [추가됨] + UUID 토큰
✅ Feature 13: 권한
   [추가됨] + 상세 권한 규칙
✅ Feature 16: 폴더
   [추가됨] + 5단계 제한
✅ Feature 20: 다크모드
```

### 나중에 확장 (10개):
```
- Feature 2: 실시간 협업 (복잡)
- Feature 3: 버전 히스토리
- Feature 5: 백링크
- Feature 9: 유사 문서
- Feature 10: AI Q&A
- Feature 14: 알림
- Feature 15: 활동 피드
- Feature 17: 태그
- Feature 18: 즐겨찾기
- Feature 19: 브랜딩
```

---

## 9. 제약사항

### MVP 제약:
- 1개 워크스페이스만
- 최대 10명 팀
- 최대 100개 문서
  [추가됨] 하드 제한: 100개 도달 시 생성 버튼 비활성화
  [추가됨] 문서 카운터 표시 (95/100)
  [추가됨] "문서 한계에 도달했습니다" 모달
- 파일 업로드 10MB
  [추가됨] 이미지만: PNG, JPG, GIF
  [추가됨] 1MB 이상 자동 압축
- 실시간 협업 X (나중에)
- [추가됨] 폴더 최대 5단계 깊이
- [추가됨] 문서 크기 제한 없음 (성능 모니터링)
- [추가됨] 제목 중복 허용

### 추후 확장:
- 다중 워크스페이스
- 무제한 팀원
- 무제한 문서
- 대용량 파일
- 실시간 협업
- 외부 연동 (Slack/Notion)
- [추가됨] 모바일 앱 또는 최적화
- [추가됨] 이메일 알림 (Resend)
- [추가됨] 추가 이미지 형식 (WebP, SVG)

---

## 10. 보안 & 프라이버시 [추가됨]

### 인증 & 권한
```
- 이메일/비밀번호: bcrypt 해싱 (최소 6자)
- Google OAuth: NextAuth.js Google Provider
- 이메일 인증: MVP에서 불필요 (즉시 사용 가능)
- 세션 관리: NextAuth.js
```

### 데이터 암호화
```
- 전송 중: HTTPS (TLS 1.3)
- 저장:
  - 비밀번호: bcrypt 해싱
  - 민감 데이터: AES-256
  - PostgreSQL TDE 또는 애플리케이션 레벨 암호화
- 공유 링크 토큰: 랜덤 UUID + 해싱
```

### AI 프라이버시 정책
```
- 문서 전체 내용이 OpenRouter API로 전송됨
- OpenRouter 데이터 보관: 30일 후 자동 삭제
- 프라이버시 정책에 명시 필수:
  "AI 기능(태그 추천, 요약)을 위해 문서 내용이
   OpenRouter(제3자 AI 서비스)로 전송됩니다.
   OpenRouter는 30일 후 데이터를 자동 삭제합니다."
- 추후 "AI 비활성화" 옵션 고려
```

---

## 11. 에러 처리 & 복원력 [추가됨]

### 네트워크 실패
```
저장 실패 시:
1. LocalStorage에 문서 내용 백업
2. 네트워크 복구 감지
3. 자동 재시도 (최대 5회, exponential backoff)
4. 재시도 중 사용자 알림 표시
5. 재시도 실패 시 "수동 재시도" 버튼 제공
6. 성공 저장 후 LocalStorage 데이터 삭제
```

### AI API 실패
```
1. 백그라운드 작업으로 AI 호출
2. 실패 시 재시도 (최대 3회)
3. 영구 실패 시:
   - 사용자에게 "AI 태깅/요약 실패" 알림
   - 문서는 정상 저장
   - 수동으로 태그 추가 가능
4. ai_jobs 테이블에 실패 로그 기록
```

### 문서 한계 도달
```
100개 문서 도달 시:
1. 문서 카운터 빨간색 표시 (100/100)
2. [+ 새 문서] 버튼 비활성화
3. 모달 표시:
   "문서 한계에 도달했습니다.
    기존 문서를 삭제하거나 Pro 플랜으로 업그레이드하세요."
4. Admin에게 알림 전송
```

---

## 12. 성공 기준

### MVP 완성:
✅ 회원가입/로그인
   [추가됨] Google OAuth 포함
✅ 문서 생성/편집/삭제
   [추가됨] 권한 규칙 적용
✅ 마크다운 편집
   [추가됨] 이미지 최적화
✅ 폴더 구조
   [추가됨] 5단계 제한
✅ 검색 작동
   [추가됨] 댓글 포함
✅ AI 태깅
   [추가됨] 수락/거부 UI
✅ AI 요약
   [추가됨] 편집 가능
✅ 댓글
   [추가됨] Viewer 권한
✅ 공유
   [추가됨] UUID 토큰
✅ 권한 관리
   [추가됨] 상세 규칙

### 실용성:
✅ 실제 팀에서 사용 가능
✅ Notion 대체 가능 (기본 기능)
✅ 5명 팀 기준 충분
✅ 속도 빠름 (1초 이내 로딩)
✅ [추가됨] 데이터 손실 방지 (LocalStorage 백업)
✅ [추가됨] 보안 (HTTPS + 암호화)

---

## 13. 차별화 포인트

```
vs Notion:
✅ 더 가벼움
✅ AI 기능 기본 탑재
   [추가됨] 자동 태깅/요약 (사용자 제어 가능)
✅ 한국어 특화
✅ 무료
✅ [추가됨] 데이터 손실 방지 (자동 백업)

vs Confluence:
✅ 현대적 UI
✅ 간단함
✅ 빠름
✅ 개발자 친화적
✅ [추가됨] MVP 제약 있지만 핵심 기능 완비

vs Obsidian:
✅ 팀 협업
✅ 클라우드
✅ 실시간 동기화 (Phase 4)
✅ 권한 관리
   [추가됨] 세밀한 권한 제어
```

---

## 14. 수익화 계획 (참고)

### Free Tier:
- 5명까지
- 100개 문서
  [추가됨] 하드 제한 적용
- 기본 기능
  [추가됨] AI 태깅/요약 포함

### Pro ($10/월):
- 무제한 팀원
- 무제한 문서
- 고급 AI 기능
  [추가됨] AI Q&A, 유사 문서 추천
- 우선 지원
- [추가됨] 버전 히스토리 무제한
- [추가됨] 이메일 알림

### Enterprise (Custom):
- 커스텀 도메인
- SSO
- 전담 지원
- SLA
- [추가됨] 온프레미스 배포 옵션
- [추가됨] 감사 로그

---

## 15. 참고 사항

### OpenRouter API:
- Model: anthropic/claude-sonnet-4
  [추가됨] 또는 openai/gpt-4o (비용/성능 테스트 필요)
- AI 태깅: ~1,000 tokens
- AI 요약: ~2,000 tokens
- $5로 100+ 문서 분석 가능
- [추가됨] 데이터 보관: 30일 후 자동 삭제

### Tiptap:
- React 기반 리치 에디터
- 확장 가능
- 마크다운 지원
- 협업 가능 (Yjs)
- [추가됨] 이미지 업로드 핸들러 커스터마이징

### Supabase:
- PostgreSQL 호스팅
- 실시간 기능
- 인증
- 스토리지
- [추가됨] 또는 Uploadthing / AWS S3 (비용 비교)

### Sharp (이미지 최적화): [추가됨]
- Node.js 이미지 처리 라이브러리
- 1MB 이상 이미지 자동 압축
- 품질 80-85%, 최대 1920px
- WebP 변환 지원 (추후)

---

## 16. 구현 우선순위 & 결정 사항 요약 [추가됨]

### High Priority (MVP 필수)
1. **인증**: Google OAuth + Email/Password (이메일 인증 X)
2. **에디터**: 이미지 최적화 + 자동 저장 백업
3. **권한**: 상세 권한 규칙 (Viewer 댓글, Editor 제한)
4. **AI**: 백그라운드 작업 + 수락/거부 UI
5. **검색**: 댓글 포함 검색
6. **제약**: 100개 문서 하드 제한 + 카운터 UI

### Medium Priority (MVP 권장)
1. **버전 히스토리**: 영구 보관
2. **폴더**: 5단계 제한 + 깊이 검증
3. **댓글**: 수정/삭제 규칙
4. **탈퇴**: 문서 유지 로직

### Low Priority (Phase 4 또는 Post-MVP)
1. 실시간 협업
2. 백링크 시각화
3. 이메일 알림
4. Slack 연동
5. 모바일 최적화

---

## 17. 의사결정 로그 [추가됨]

### 인증 & 온보딩
- ✅ 이메일 인증 불필요 → 빠른 온보딩 우선
- ✅ 비밀번호 6자 이상 → 사용자 편의 우선
- ✅ Google 로그인 → 기업 팀 타겟

### 파일 & 미디어
- ✅ PNG/JPG/GIF만 → MVP 단순화
- ✅ 1MB 이상 자동 압축 → 저장공간/성능 최적화
- ✅ 문서 삭제 시 이미지도 삭제 → 저장공간 절감

### AI 기능
- ✅ 저장 시 자동 실행 → 자동화 브랜드
- ✅ 사용자 수락/거부 → 유연성 보장
- ✅ 전체 내용 전송 → AI 정확도 우선
- ✅ 댓글 포함 검색 → 포괄적 지식 관리

### 협업 & 권한
- ✅ Viewer 댓글 가능 → 협업 활성화
- ✅ Editor 자기 문서만 삭제 → 안전성 우선
- ✅ 탈퇴 멤버 문서 유지 → 지식 보존
- ✅ 댓글: 작성자+Admin → 일반적 패턴

### 데이터 & 성능
- ✅ 버전 영구 보관 → 완전한 이력 추적
- ✅ 문서 크기 무제한 → 유연성 최대화
- ✅ 폴더 5단계 → UI 가독성 유지
- ✅ 전체 암호화 → 보안 최대화

### 엣지 케이스
- ✅ LocalStorage 백업 → 데이터 손실 방지
- ✅ 100개 하드 제한 → MVP 제약 명확화
- ✅ 제목 중복 허용 → 유연성 우선
- ✅ 데스크톱 우선 → MVP 개발 시간 절감

---

## 18. 다음 단계 [추가됨]

1. ✅ 인터뷰 완료
2. ✅ SRS_FINAL.md 생성 완료
3. ⏸️ **여기서 멈춤 - 구현하지 않음**
4. ⏭️ 사용자가 별도로 지시할 때까지 대기
5. ⏭️ 구현은 사용자 승인 후 시작

---

## Document History [추가됨]

| Version | Date | Changes |
|---------|------|---------|
| 1.0 Draft | - | Original SRS.md |
| 1.0 Final | 2026-01-27 | + INTERVIEW.md 요구사항 명확화 반영 |

**변경 사항 범례:**
- `[추가됨]` - 인터뷰를 통해 새로 추가된 요구사항
- `[수정됨]` - 기존 요구사항의 명확화 또는 변경
