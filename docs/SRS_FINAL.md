# AI Help Desk - SRS (최종)

> 이 문서는 INTERVIEW.md의 결정 사항을 반영하여 업데이트되었습니다.
> - [추가됨]: 인터뷰를 통해 새로 추가된 요구사항
> - [수정됨]: 기존 요구사항이 명확화되거나 변경된 항목

---

## 목적

고객 문의 티켓 관리 + AI 답변 제안 시스템

---

## 사용자

| 역할 | 설명 | 주요 기능 |
|------|------|----------|
| Customer | 문의 등록 | 티켓 생성, 댓글 추가, 만족도 평가 [수정됨] |
| Agent | 티켓 처리, AI 답변 활용 | 티켓 처리, AI 답변 수정/승인, 내부 노트 작성 [수정됨] |
| Manager | 팀 관리, 보고서 | 대시보드 조회, 통계 확인, 담당자 관리 [수정됨] |
| Admin | 시스템 설정, Back Office | 사용자/카테고리/AI 템플릿 관리 [수정됨] |

### 사용자 인증 [추가됨]
- **인증 방식**: 이메일/비밀번호 로그인
- **고객 등록**: 자유 회원가입 (별도 승인 불필요)
- **권한 체계**: 역할 기반 접근 제어 (RBAC)

---

## 주요 기능

### Main App

#### 1. 티켓 CRUD

##### 티켓 생성 [추가됨]
- **등록 방식**: 웹 포털 전용 (고객이 로그인하여 직접 작성)
- **필수 필드**: 제목, 내용
- **선택 필드**: 카테고리, 우선순위, 첨부파일

##### 티켓 우선순위 [추가됨]
- **3단계 체계**: Low / Medium / High
- 고객이 티켓 생성 시 선택 가능
- Agent/Manager가 변경 가능

##### 티켓 카테고리 [추가됨]
- **1단계 구조**: 단순 평면 목록 (예: 결제, 배송, 반품, 계정, 기타)
- Admin이 Back Office에서 관리

##### 파일 첨부 [추가됨]
- **허용 파일**: 이미지 (jpg, png, gif) + 문서 (pdf, docx, xlsx)
- **크기 제한**: 파일당 최대 5MB
- **개수 제한**: 티켓당 최대 5개 (권장)

#### 2. 티켓 상태 (Open → In Progress → Resolved → Closed)

##### 상태 흐름 [수정됨]
```
Open → In Progress → Resolved → Closed
  ↑                      │
  └──────────────────────┘ (3일 내 재오픈 가능)
```

##### 티켓 재오픈 [추가됨]
- Closed 후 **3일 이내** 고객이 재오픈 가능
- 재오픈 시 상태가 Open으로 변경
- 3일 경과 후에는 새 티켓으로 문의

##### 이력 추적 [추가됨]
- **전체 이력 추적**: 상태 변경, 담당자 변경, 내용 수정 등 모든 변경 기록
- 변경 시점, 변경자, 변경 내용 저장

#### 3. AI 답변 제안 (LLM)

##### AI 답변 승인 프로세스 [수정됨]
- Agent가 AI 초안을 확인
- Agent가 직접 수정 후 승인
- 승인된 답변이 고객에게 전송 (2단계 승인 없음)

##### AI 실패 처리 [추가됨]
- AI가 답변을 생성하지 못하는 경우
- Agent가 처음부터 직접 답변 작성
- 별도 에스컬레이션 없음

#### 4. 답변 수정/승인 후 전송

##### 답변 전달 방식 [추가됨]
- **이메일 전송**: 고객 이메일로 답변 발송
- 웹 포털에서도 답변 확인 가능

##### 양방향 대화 [추가됨]
- 고객이 티켓에 추가 댓글/정보 제공 가능
- Agent-고객 간 대화 형식으로 진행

##### 내부 노트 [추가됨]
- Agent끼리 내부 메모 작성 가능
- 고객에게 비공개
- 인수인계, 참고사항 기록용

#### 5. 담당자 할당 [수정됨]

##### 자동 할당 (Round-robin) [추가됨]
- 새 티켓 생성 시 시스템이 자동으로 담당자 배정
- **온라인 Agent만** 할당 대상
- 순차적으로 균등 배분

##### 부재 시 처리 [추가됨]
- Agent가 부재(휴가/퇴사) 설정 시
- 해당 Agent의 미처리 티켓 자동 재할당
- 다른 온라인 Agent에게 배분

##### 팀 구조 [추가됨]
- **단일 팀**: 모든 Agent가 하나의 팀에 소속
- 별도 팀/그룹 구분 없음

#### 6. 고객 이력 조회

- 해당 고객의 과거 티켓 목록 조회
- 티켓별 상태, 처리 내역 확인

#### 7. 대시보드 [수정됨]

##### 기본 지표 [추가됨]
- 상태별 티켓 수 (Open / In Progress / Resolved / Closed)
- 오늘 생성된 티켓 수
- 오늘 해결된 티켓 수

##### 검색/필터링 [추가됨]
- **기본 필터링**: 상태, 담당자, 날짜, 카테고리, 우선순위
- 고급 검색 (키워드, AI 유사도) 미지원

---

### Back Office

> Main App과 **통합** 운영 (동일 URL, 권한으로 메뉴 구분) [추가됨]

#### 1. 사용자/팀 관리

- 사용자 CRUD (Customer, Agent, Manager, Admin)
- Agent 온라인/오프라인 상태 관리 [추가됨]
- Agent 부재 설정 (휴가, 퇴사) [추가됨]

#### 2. 카테고리 관리

- 1단계 카테고리 CRUD [수정됨]
- 카테고리별 AI 프롬프트 템플릿 연결 [추가됨]

#### 3. AI 프롬프트 템플릿 [수정됨]

- **카테고리별 템플릿** 관리 [추가됨]
- 각 카테고리마다 다른 AI 프롬프트 설정 가능
- 기본 템플릿 + 카테고리 오버라이드

#### 4. FAQ/지식베이스 관리 [수정됨]

- **내부용** (Agent/Manager만 접근 가능) [추가됨]
- AI 답변 생성을 위한 참고 자료
- 고객 공개 FAQ 미지원

#### 5. 통계/보고서 [수정됨]

- **화면 조회만** [추가됨]
- Excel/CSV 내보내기 미지원
- 자동 보고서 발송 미지원

---

### LLM 기능

#### 1. 문의 자동 분류
- 티켓 내용 기반 카테고리 자동 추천
- Agent가 확인 후 수정 가능

#### 2. 답변 초안 생성
- 지식베이스 참조하여 답변 초안 생성
- **카테고리별 프롬프트 템플릿** 적용 [추가됨]
- Agent 승인 필수

#### 3. 유사 티켓 검색
- 과거 유사 티켓 및 답변 검색
- Agent 참고용

#### 4. 감정 분석 [수정됨]
- 고객 문의 내용의 감정 분석
- **표시만 (참고용)**: 부정/중립/긍정 [추가됨]
- 우선순위 자동 변경 미적용
- Agent 참고용으로만 활용

---

### SLA (서비스 수준 협약) [추가됨]

#### 기본 SLA 기준
| 항목 | 목표 시간 |
|------|----------|
| 첫 응답 시간 | 1시간 |
| 티켓 해결 시간 | 24시간 |

#### SLA 기능
- 모든 티켓에 동일한 SLA 적용 (우선순위별 차등 없음)
- SLA 위반 시 이메일 알림
- 에스컬레이션 기능 미지원

---

### 알림 시스템 [추가됨]

#### 알림 방식
- **이메일 알림만** (웹 푸시 미지원)

#### 알림 대상 및 이벤트

| 대상 | 이벤트 |
|------|--------|
| Agent | 새 티켓 할당, 고객 댓글 추가, SLA 경고 |
| Manager | SLA 위반, 일일 요약 |
| Customer | 답변 등록, 티켓 상태 변경 |

---

### 고객 만족도 [추가됨]

- 티켓 Resolved 상태 시 만족도 평가 요청
- **5점 척도** (1~5점)
- 선택 사항 (필수 아님)
- 통계에서 평균 만족도 조회 가능

---

## 비기능 요구사항 [추가됨]

### 언어
- **한국어 단일 언어** 지원
- 다국어 미지원

### 반응형 디자인
- **반응형 웹** (모바일 최적화)
- 데스크톱/태블릿/모바일 모두 지원
- 네이티브 앱 미지원

### 데이터 보존
- **영구 보존**: 모든 티켓 데이터 영구 보관
- 자동 삭제/아카이브 정책 없음

### 보안
- 민감 정보(개인정보) 포함 가능
- 별도 마스킹 처리 없음
- HTTPS 적용

---

## 제약사항 [추가됨]

### 미지원 기능
- 티켓 병합/분리
- 다국어
- 웹 푸시 알림
- 고급 검색 (AI 유사도)
- Excel/CSV 내보내기
- 고객용 공개 FAQ
- 에스컬레이션 (자동/수동)
- 복잡한 팀 구조 (단일 팀만)
- 우선순위별 SLA 차등

### 제한 사항
- 첨부파일: 5MB/파일
- 티켓 재오픈: 3일 이내

---

## 기술 스택

- Next.js 16 + TypeScript
- PostgreSQL + Drizzle ORM
- shadcn/ui + Recharts
- OpenRouter API (LLM)
- NextAuth.js

### 추가 기술 요소 [추가됨]
- 이메일 발송: Nodemailer 또는 외부 서비스 (SendGrid, AWS SES 등)
- 파일 저장: 로컬 또는 클라우드 스토리지

---

## 데이터 모델 개요 [추가됨]

### 주요 엔티티

```
User (사용자)
├── id, email, password, name, role
├── isOnline (Agent 온라인 상태)
└── isAway (Agent 부재 상태)

Ticket (티켓)
├── id, title, content, status
├── priority (Low/Medium/High)
├── categoryId, customerId, agentId
├── createdAt, updatedAt, resolvedAt, closedAt
└── slaResponseDeadline, slaResolveDeadline

TicketComment (댓글)
├── id, ticketId, userId, content
├── isInternal (내부 노트 여부)
└── createdAt

TicketHistory (변경 이력)
├── id, ticketId, userId
├── field, oldValue, newValue
└── createdAt

TicketAttachment (첨부파일)
├── id, ticketId, fileName, filePath, fileSize
└── createdAt

Category (카테고리)
├── id, name
└── aiPromptTemplate

KnowledgeBase (지식베이스)
├── id, title, content, categoryId
└── createdAt, updatedAt

CustomerSatisfaction (만족도)
├── id, ticketId, rating (1-5)
└── createdAt
```

---

## 화면 목록 [추가됨]

### Customer 화면
1. 로그인/회원가입
2. 티켓 목록 (내 티켓)
3. 티켓 상세/댓글 작성
4. 새 티켓 작성
5. 만족도 평가

### Agent 화면
1. 대시보드 (할당된 티켓 현황)
2. 티켓 목록 (필터링)
3. 티켓 상세 (AI 답변 제안, 내부 노트)
4. 고객 이력 조회

### Manager 화면
1. 대시보드 (전체 현황)
2. 티켓 목록 (전체)
3. 통계/보고서

### Admin 화면 (Back Office)
1. 사용자 관리
2. 카테고리 관리
3. AI 프롬프트 템플릿 관리
4. 지식베이스 관리

---

*문서 버전: 1.0 (최종)*
*작성일: 2026-01-29*
*기반 문서: SRS.md, INTERVIEW.md*
